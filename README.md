# Discordæ—¥æ¬¡ã‚µãƒãƒªãƒ¼Bot ä»•æ§˜æ›¸

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
**ä½œæˆæ—¥**: 2025å¹´8æœˆ12æ—¥

---

## 1. æ¦‚è¦

### 1.1. ã‚·ã‚¹ãƒ†ãƒ ç›®çš„
æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯ã€æŒ‡å®šã•ã‚ŒãŸDiscordã‚µãƒ¼ãƒãƒ¼å†…ã®å…¨ãƒãƒ£ãƒ³ãƒãƒ«ãŠã‚ˆã³ã‚¹ãƒ¬ãƒƒãƒ‰ã«ãŠã‘ã‚‹éå»24æ™‚é–“ã®æ´»å‹•å†…å®¹ã‚’ã€Google Gemini APIã‚’åˆ©ç”¨ã—ã¦è¦ç´„ã—ã€æ¯æ—¥å®šæ™‚ã«æŒ‡å®šãƒãƒ£ãƒ³ãƒãƒ«ã¸æŠ•ç¨¿ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¡ãƒ³ãƒãƒ¼ã¯ã‚µãƒ¼ãƒãƒ¼å†…ã®å…¨ä½“åƒã‚’åŠ¹ç‡çš„ã«æŠŠæ¡ã§ãã‚‹ã€‚

### 1.2. ä¸»è¦æ©Ÿèƒ½
-   **å®šæ™‚è‡ªå‹•å®Ÿè¡Œ**: æ¯æ—¥åˆå‰9~10æ™‚ï¼ˆæ—¥æœ¬æ™‚é–“ï¼‰ã«ã‚µãƒãƒªãƒ¼ä½œæˆã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•ã§å®Ÿè¡Œã™ã‚‹ã€‚
-   **ç¶²ç¾…çš„ãªãƒ‡ãƒ¼ã‚¿åé›†**: æ¨©é™ã®ã‚ã‚‹å…¨ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ãƒãƒ«ãŠã‚ˆã³ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¹ãƒ¬ãƒƒãƒ‰ã®æŠ•ç¨¿ã‚’åé›†å¯¾è±¡ã¨ã™ã‚‹ã€‚
-   **AIã«ã‚ˆã‚‹å†…å®¹è¦ç´„**: åé›†ã—ãŸãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‚’Google Gemini APIã«é€ä¿¡ã—ã€æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«åŸºã¥ã„ãŸé«˜å“è³ªãªè¦ç´„ã‚’ç”Ÿæˆã™ã‚‹ã€‚
-   **Discordã¸ã®è‡ªå‹•æŠ•ç¨¿**: ç”Ÿæˆã•ã‚ŒãŸã‚µãƒãƒªãƒ¼ã‚’ã€æŒ‡å®šã•ã‚ŒãŸDiscordãƒãƒ£ãƒ³ãƒãƒ«ã«è‡ªå‹•ã§æŠ•ç¨¿ã™ã‚‹ã€‚

---

## 2. æ©Ÿèƒ½ä»•æ§˜

### 2.1. å®šæœŸå®Ÿè¡Œæ©Ÿèƒ½
-   **ãƒˆãƒªã‚¬ãƒ¼**: Vercel Cron Job
-   **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«**: `0 0 * * *` (UTC)ã€‚æ—¥æœ¬æ™‚é–“ã®æ¯æ—¥åˆå‰9~10æ™‚ã«è¨­å®šã€‚
-   **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: `/api/daily_summary`ã®ãƒ‘ã‚¹ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€Pythonã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹é–¢æ•°ã‚’èµ·å‹•ã™ã‚‹ã€‚

### 2.2. ãƒ‡ãƒ¼ã‚¿åé›†æ©Ÿèƒ½
-   **åé›†å¯¾è±¡**: æŒ‡å®šã•ã‚ŒãŸã‚µãƒ¼ãƒãƒ¼ï¼ˆGuildï¼‰å†…ã®ã€BotãŒ`ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´ã‚’èª­ã‚€`æ¨©é™ã‚’æŒã¤å…¨ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ãƒãƒ«ãŠã‚ˆã³ãã®ä¸­ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¹ãƒ¬ãƒƒãƒ‰ã€‚
-   **åé›†æœŸé–“**: å®Ÿè¡Œæ™‚ã‹ã‚‰é¡ã£ã¦éå»24æ™‚é–“ã€‚
-   **åé›†ãƒ‡ãƒ¼ã‚¿**: ãƒãƒ£ãƒ³ãƒãƒ«åã€ã‚¹ãƒ¬ãƒƒãƒ‰åã€æŠ•ç¨¿è€…åï¼ˆã‚µãƒ¼ãƒãƒ¼ã§ã®è¡¨ç¤ºåï¼‰ã€æŠ•ç¨¿æ™‚åˆ»ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æœ¬æ–‡ã€‚
-   **é™¤å¤–å¯¾è±¡**: Botã«ã‚ˆã‚‹æŠ•ç¨¿ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æœ¬æ–‡ãŒç©ºã®æŠ•ç¨¿ã€‚

### 2.3. è¦ç´„ç”Ÿæˆæ©Ÿèƒ½
-   **ä½¿ç”¨ã‚µãƒ¼ãƒ“ã‚¹**: Google Gemini API
-   **ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«**: `gemini-1.5-pro-latest`
-   **ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**: åé›†ã—ãŸå…¨ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‚’ä»˜ä¸ã—ã€ä»¥ä¸‹ã®è¦ä»¶ã«åŸºã¥ãè¦ç´„ã‚’æŒ‡ç¤ºã™ã‚‹ã€‚
    -   å…¨ãƒãƒ£ãƒ³ãƒãƒ«ãƒ»ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ç¶²ç¾…ã™ã‚‹ã“ã¨ã€‚
    -   æŠ•ç¨¿ãŒãªã‹ã£ãŸãƒãƒ£ãƒ³ãƒãƒ«ã¯ã€ŒæŠ•ç¨¿ãªã—ã€ã¨æ˜è¨˜ã™ã‚‹ã“ã¨ã€‚
    -   æ™‚åˆ»ã€æŠ•ç¨¿è€…ã€ä¸»æ—¨ã‚’ç°¡æ½”ã«ã¾ã¨ã‚ã‚‹ã“ã¨ã€‚
    -   æŒ‡å®šã•ã‚ŒãŸå‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¾‹ã«å¾“ã†ã“ã¨ã€‚

### 2.4. æŠ•ç¨¿æ©Ÿèƒ½
-   **æŠ•ç¨¿æ–¹å¼**: Discord Webhook
-   **æŠ•ç¨¿å…ˆ**: ç’°å¢ƒå¤‰æ•°ã§æŒ‡å®šã•ã‚ŒãŸå˜ä¸€ã®ãƒãƒ£ãƒ³ãƒãƒ«ã€‚
-   **æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**:
    1.  Pythonå´ã§ç¾åœ¨ã®æ—¥ä»˜ã¨æ›œæ—¥ã‚’å«ã‚€å›ºå®šã‚¿ã‚¤ãƒˆãƒ«ã‚’ç”Ÿæˆã€‚
        -   `ğŸ—“ï¸ YYYYå¹´MMæœˆDDæ—¥ï¼ˆæ›œï¼‰æŠ•ç¨¿ã‚µãƒãƒªãƒ¼ï¼ˆå…¨ãƒãƒ£ãƒ³ãƒãƒ«ç¢ºèªæ¸ˆï¼‰`
    2.  Gemini APIã‹ã‚‰è¿”å´ã•ã‚ŒãŸè¦ç´„æœ¬æ–‡ã‚’ä¸Šè¨˜ã‚¿ã‚¤ãƒˆãƒ«ã®ä¸‹ã«çµåˆã™ã‚‹ã€‚
    3.  Discordã®æ–‡å­—æ•°åˆ¶é™ï¼ˆ2000æ–‡å­—ï¼‰ã‚’è¶…ãˆã‚‹å ´åˆã¯ã€è‡ªå‹•ã§åˆ†å‰²ã—ã¦é€£ç¶šæŠ•ç¨¿ã™ã‚‹ã€‚

---

## 3. éæ©Ÿèƒ½è¦ä»¶

### 3.1. å®Ÿè¡Œç’°å¢ƒ
-   **ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **: Vercel

### 3.2. ä½¿ç”¨è¨€èªãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
-   **è¨€èª**: Python
-   **ä¸»è¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**:
    -   `discord.py`: ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã®èª­ã¿å–ã‚Šç”¨
    -   `google-generativeai`: Gemini APIã¨ã®é€£æºç”¨
    -   `requests`: Discord Webhookã¸ã®æŠ•ç¨¿ç”¨

### 3.3. å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æº
-   Discord API (Bot TokençµŒç”±)
-   Google Gemini API (API KeyçµŒç”±)
-   Discord Webhook (Webhook URLçµŒç”±)

### 3.4. ç’°å¢ƒå¤‰æ•°
Vercelã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šã§ã€ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
-   `DISCORD_BOT_TOKEN`: Discordã‹ã‚‰ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®Botãƒˆãƒ¼ã‚¯ãƒ³ã€‚
-   `GEMINI_API_KEY`: Google Gemini APIã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã®APIã‚­ãƒ¼ã€‚
-   `DISCORD_WEBHOOK_URL`: ã‚µãƒãƒªãƒ¼ã‚’æŠ•ç¨¿ã™ã‚‹å…ˆã®ãƒãƒ£ãƒ³ãƒãƒ«ã®Webhook URLã€‚

## 4. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
```
.
â”œâ”€â”€ api/
â”‚   â””â”€â”€ daily_summary.py   # ãƒ¡ã‚¤ãƒ³ã®Pythonã‚³ãƒ¼ãƒ‰
â”œâ”€â”€ requirements.txt         # ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¸€è¦§
â””â”€â”€ vercel.json              # Vercel Cron Jobè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
```

## 5. ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
```mermaid
graph TD
    subgraph "Vercelãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ "
        Cron(â° Vercel Cron Job)
        ServerlessFunc[ğŸ¤– Pythonã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹é–¢æ•°]
    end

    subgraph "å¤–éƒ¨API"
        DiscordAPI(ğŸ”Œ Discord API)
        GeminiAPI(ğŸ§  Google Gemini API)
    end

    subgraph "Discord"
        Server(ğŸ¢ Discordã‚µãƒ¼ãƒãƒ¼)
        TargetChannel(ğŸ¯ æŠ•ç¨¿å…ˆãƒãƒ£ãƒ³ãƒãƒ«)
    end

    %% ãƒ•ãƒ­ãƒ¼
    Cron -- "æ¯æ—¥10æ™‚ (JST)ã«å®Ÿè¡Œ" --> ServerlessFunc
    ServerlessFunc -- "Botãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ã„ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‚’è¦æ±‚" --> DiscordAPI
    DiscordAPI -- "å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™" --> ServerlessFunc
    ServerlessFunc -- "å±¥æ­´ã‚’é€ä¿¡ã—è¦ç´„ã‚’ä¾é ¼" --> GeminiAPI
    GeminiAPI -- "è¦ç´„ãƒ†ã‚­ã‚¹ãƒˆã‚’è¿”ã™" --> ServerlessFunc
    ServerlessFunc -- "Webhookã§ã‚µãƒãƒªãƒ¼ã‚’æŠ•ç¨¿" --> TargetChannel
    TargetChannel -- "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤º" --> Server
```
